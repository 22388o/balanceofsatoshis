#!/usr/bin/env node
const prog = require('caporal');

const {getBalance} = require('./funds');
const {version} = require('./package');

prog
  .version(version)
  .command('balance', 'Get total tokens')
  .option('--above <tokens>', 'Return tokens above watermark', prog.INT)
  .option('--below <tokens>', 'Return tokens below watermark', prog.INT)
  .option('--offchain', 'List only off-chain tokens')
  .option('--onchain', 'List only on-chain tokens')
  .action((args, options, logger) => {
    return new Promise((resolve, reject) => {
      return getBalance({
        above: options.above || undefined,
        below: options.below || undefined,
        is_offchain_only: !!options.offchain,
        is_onchain_only: !!options.onchain,
      },
      (err, res) => {
        if (!!err) {
          return reject(err);
        }

        const {balance} = res;

        logger.info(`${balance}`);

        return resolve();
      });
    });
  });
 
prog.parse(process.argv);
